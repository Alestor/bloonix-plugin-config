{
   "plugin" : {
      "abstract" : "Netstat check",
      "plugin" : "Linux.Netstat.Check",
      "command" : "check-netstat",
      "description" : "Linux netstat statistics",
      "category" : "System,Network,Linux",
      "info" : {
         "version" : "0.8",
         "options" : [
            {
               "name" : "Warning threshold",
               "value_desc" : "key:value or key:op:value",
               "mandatory" : 0,
               "multiple" : 1,
               "default" : null,
               "value_type" : "string",
               "option" : "warning",
               "description" : "This is the warning threshold. When the value exceeds the threshold a warning status is triggered. Please see the examples for more information."
            },
            {
               "value_desc" : "key:value or key:op:value",
               "name" : "Critical threshold",
               "mandatory" : 0,
               "default" : null,
               "value_type" : "string",
               "multiple" : 1,
               "description" : "This is the critical threshold. When the value exceeds the threshold a critical status is triggered. Please see the examples for more information.",
               "option" : "critical"
            }
         ],
         "examples" : [
            {
               "arguments" : [
                  "warning",
                  "established:ge:500",
                  "critical",
                  "established:ge:750"
               ],
               "description" : [
                  "An example to check the current established connections and trigger",
                  "",
                  "- a warning status if the number of established connections is higher than or equal 500",
                  "- or a critical status if the number of established connections is higher than or equal 700"
               ],
               "command_line" : "check-netstat --warning 'established:ge:500' --critical 'established:ge:750'"
            }
         ],
         "plugin" : "check-netstat",
         "thresholds" : {
            "info" : [
               "How to set warning and critical thresholds:\n\n",
               "  It's possible to set thresholds for one or more statistic keys.\n",
               "  The format to add a threshold for a statistic key is:\n\n",
               "    key:operator:threshold\n\n",
               "  If no operator is set then the default operator is 'ge'.\n\n",
               "  The following operators are available:\n\n",
               "    lt = less than\n",
               "    le = less than or equal\n",
               "    gt = greater than\n",
               "    ge = greater than or equal\n",
               "    eq = equal\n",
               "    ne = not equal\n"
            ],
            "options" : [
               {
                  "unit" : "none",
                  "key" : "recv_resets"
               },
               {
                  "key" : "sent_resets",
                  "unit" : "none"
               },
               {
                  "unit" : "none",
                  "key" : "recv_udp_pcks"
               },
               {
                  "unit" : "none",
                  "key" : "sent_udp_pcks"
               },
               {
                  "key" : "active",
                  "unit" : "none"
               },
               {
                  "key" : "passive",
                  "unit" : "none"
               },
               {
                  "key" : "failed",
                  "unit" : "none"
               },
               {
                  "key" : "established",
                  "unit" : "none"
               },
               {
                  "unit" : "none",
                  "key" : "syn_send"
               },
               {
                  "key" : "syn_recv",
                  "unit" : "none"
               },
               {
                  "unit" : "none",
                  "key" : "fin_wait1"
               },
               {
                  "unit" : "none",
                  "key" : "fin_wait2"
               },
               {
                  "key" : "time_wait",
                  "unit" : "none"
               },
               {
                  "key" : "close",
                  "unit" : "none"
               },
               {
                  "unit" : "none",
                  "key" : "close_wait"
               },
               {
                  "key" : "last_ack",
                  "unit" : "none"
               },
               {
                  "unit" : "none",
                  "key" : "closing"
               },
               {
                  "key" : "unknown",
                  "unit" : "none"
               }
            ]
         },
         "flags" : "",
         "info" : [
            "The command 'netstat' is used to check the network statistics."
         ]
      },
      "id" : "28",
      "datatype" : "statistic"
   },
   "chart" : [
      {
         "options" : {
            "series" : [
               {
                  "color" : "#ffb244",
                  "name" : "active"
               },
               {
                  "color" : "#005467",
                  "name" : "passive"
               },
               {
                  "name" : "failed",
                  "color" : "#e9644a"
               }
            ],
            "ylabel" : "connections/s",
            "chart-type" : "area",
            "units" : "default"
         },
         "title" : "Linux netstat - connections/s",
         "id" : "1"
      },
      {
         "id" : "2",
         "title" : "Linux netstat - established connections/s",
         "options" : {
            "series" : {
               "name" : "established",
               "color" : "#005467"
            },
            "ylabel" : "established",
            "units" : "default",
            "chart-type" : "area"
         }
      },
      {
         "id" : "3",
         "title" : "Linux netstat - connection resets/s",
         "options" : {
            "chart-type" : "area",
            "units" : "default",
            "ylabel" : "recv/s (-) / sent/s (+)",
            "series" : [
               {
                  "name" : "sent_resets",
                  "color" : "#005467"
               },
               {
                  "name" : "recv_resets",
                  "opposite" : "true",
                  "color" : "#ff7a0d"
               }
            ]
         }
      },
      {
         "options" : {
            "ylabel" : "recv/s (-) / sent/s (+)",
            "series" : [
               {
                  "name" : "sent_udp_pcks",
                  "color" : "#005467"
               },
               {
                  "name" : "recv_udp_pcks",
                  "opposite" : "true",
                  "color" : "#ff7a0d"
               }
            ],
            "units" : "default",
            "chart-type" : "area"
         },
         "id" : "4",
         "title" : "Linux netstat - udp packets/s"
      },
      {
         "options" : {
            "series" : [
               {
                  "name" : "established",
                  "color" : "#e9644a"
               },
               {
                  "color" : "#ffb244",
                  "name" : "syn_send"
               },
               {
                  "name" : "syn_recv",
                  "color" : "#9a72ad"
               },
               {
                  "name" : "fin_wait1",
                  "color" : "#005467"
               },
               {
                  "name" : "fin_wait2",
                  "color" : "#2ba743"
               },
               {
                  "name" : "time_wait",
                  "color" : "#7648eb"
               },
               {
                  "name" : "close",
                  "color" : "#7f7fff"
               },
               {
                  "color" : "#1c6d16",
                  "name" : "close_wait"
               },
               {
                  "color" : "#bf00bf",
                  "name" : "last_ack"
               },
               {
                  "name" : "closing",
                  "color" : "#275487"
               },
               {
                  "name" : "unknown",
                  "color" : "#666666"
               }
            ],
            "ylabel" : "connections",
            "units" : "null",
            "chart-type" : "area"
         },
         "title" : "Linux netstat - current connections",
         "id" : "5"
      }
   ],
   "statistic" : [
      {
         "statkey" : "active",
         "datatype" : "float",
         "description" : "Number of active connections per second.",
         "alias" : "Active"
      },
      {
         "alias" : "Passive",
         "description" : "Number of passive connections per second.",
         "statkey" : "passive",
         "datatype" : "float"
      },
      {
         "datatype" : "float",
         "statkey" : "failed",
         "description" : "Number of failed connections per second.",
         "alias" : "Failed"
      },
      {
         "alias" : "Received resets",
         "datatype" : "float",
         "statkey" : "recv_resets",
         "description" : "Number of connection resets received per second."
      },
      {
         "alias" : "Sent resets",
         "description" : "Number of connection resets sent per second.",
         "statkey" : "sent_resets",
         "datatype" : "float"
      },
      {
         "description" : "Number of udp packets received per second.",
         "datatype" : "float",
         "statkey" : "recv_udp_pcks",
         "alias" : "Received UDP packets"
      },
      {
         "alias" : "Sent UDP packets",
         "description" : "Number of udp packets sent per second.",
         "statkey" : "sent_udp_pcks",
         "datatype" : "float"
      },
      {
         "description" : "Number of udp packet receive errors per second.",
         "statkey" : "recv_udp_errs",
         "datatype" : "float",
         "alias" : "Received UDP errors"
      },
      {
         "alias" : "Established",
         "description" : "ESTABLISHED - The socket has an established connection.",
         "statkey" : "established",
         "datatype" : "bigint"
      },
      {
         "alias" : "SYN sent",
         "description" : "SYN_SENT - The socket is actively attempting to establish a connection.",
         "datatype" : "bigint",
         "statkey" : "syn_send"
      },
      {
         "alias" : "SYN received",
         "statkey" : "syn_recv",
         "datatype" : "bigint",
         "description" : "SYN_RECV - A connection request has been received from the network."
      },
      {
         "description" : "FIN_WAIT1 - The socket is closed, and the connection is shutting down.",
         "statkey" : "fin_wait1",
         "datatype" : "bigint",
         "alias" : "FIN wait1"
      },
      {
         "datatype" : "bigint",
         "statkey" : "fin_wait2",
         "description" : "FIN_WAIT2 - Connection is closed, and the socket is waiting for a shutdown from the remote end.",
         "alias" : "FIN wait2"
      },
      {
         "alias" : "Time wait",
         "statkey" : "time_wait",
         "datatype" : "bigint",
         "description" : "TIME_WAIT - The socket is waiting after close to handle packets still in the network."
      },
      {
         "alias" : "Close",
         "description" : "CLOSE - The socket is not being used.",
         "statkey" : "close",
         "datatype" : "bigint"
      },
      {
         "description" : "CLOSE_WAIT - The remote end has shut down, waiting for the socket to close.",
         "statkey" : "close_wait",
         "datatype" : "bigint",
         "alias" : "Close wait"
      },
      {
         "alias" : "Last ACK",
         "datatype" : "bigint",
         "statkey" : "last_ack",
         "description" : "LAST_ACK - The remote end has shut down, and the socket is closed. Waiting for acknowledgement."
      },
      {
         "alias" : "Closing",
         "statkey" : "closing",
         "datatype" : "bigint",
         "description" : "CLOSING - Both sockets are shut down but we still don't have all our data sent."
      },
      {
         "alias" : "Unknown",
         "statkey" : "unknown",
         "datatype" : "bigint",
         "description" : "UNKNOWN - The state of the socket is unknown."
      }
   ]
}
