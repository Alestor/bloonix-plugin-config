{
   "plugin" : {
      "datatype" : "statistic",
      "category" : "System,Network,Linux",
      "command" : "check-netstat-port",
      "id" : "29",
      "description" : "Linux netstat statistics by port",
      "abstract" : "Netstat port check",
      "plugin" : "Linux.NetstatPort.Check",
      "info" : {
         "flags" : "",
         "thresholds" : {
            "info" : [
               "How to set warning and critical thresholds:\n\n",
               "  It's possible to set thresholds for one or more statistic keys.\n",
               "  The format to add a threshold for a statistic key is:\n\n",
               "    key:operator:threshold\n\n",
               "  If no operator is set then the default operator is 'ge'.\n\n",
               "  The following operators are available:\n\n",
               "    lt = less than\n",
               "    le = less than or equal\n",
               "    gt = greater than\n",
               "    ge = greater than or equal\n",
               "    eq = equal\n",
               "    ne = not equal\n"
            ],
            "options" : [
               {
                  "key" : "syn_send",
                  "unit" : "none"
               },
               {
                  "unit" : "none",
                  "key" : "syn_recv"
               },
               {
                  "key" : "fin_wait1",
                  "unit" : "none"
               },
               {
                  "key" : "fin_wait2",
                  "unit" : "none"
               },
               {
                  "unit" : "none",
                  "key" : "time_wait"
               },
               {
                  "unit" : "none",
                  "key" : "close"
               },
               {
                  "key" : "close_wait",
                  "unit" : "none"
               },
               {
                  "unit" : "none",
                  "key" : "last_ack"
               },
               {
                  "key" : "closing",
                  "unit" : "none"
               },
               {
                  "unit" : "none",
                  "key" : "established"
               }
            ]
         },
         "examples" : [
            {
               "command_line" : "check-netstat-port --port '80' --warning 'established:ge:500' --critical 'established:ge:750'",
               "arguments" : [
                  "port",
                  80,
                  "warning",
                  "established:ge:500",
                  "critical",
                  "established:ge:750"
               ],
               "description" : [
                  "An example to check the current established connections to the HTTP port and trigger",
                  "",
                  "- a warning status if the number of established connections is higher than or equal 500",
                  "- or a critical status if the number of established connections is higher than or equal 700"
               ]
            }
         ],
         "version" : "0.5",
         "plugin" : "check-netstat-port",
         "options" : [
            {
               "option" : "port",
               "mandatory" : 1,
               "name" : "Port number",
               "default" : null,
               "value_desc" : "port",
               "value_type" : "int",
               "description" : "A port number to connect to.",
               "multiple" : 0
            },
            {
               "multiple" : 0,
               "default" : null,
               "description" : "By default the connection to the local port are checked. Enable this option if you want to check the connections to the remote port.",
               "value_type" : 0,
               "name" : "Remote port",
               "option" : "remote",
               "mandatory" : 0
            },
            {
               "default" : null,
               "value_desc" : "key:value or key:op:value",
               "option" : "warning",
               "mandatory" : 0,
               "name" : "Warning threshold",
               "description" : "This is the warning threshold. When the value exceeds the threshold a warning status is triggered. Please see the examples for more information.",
               "multiple" : 1,
               "value_type" : "string"
            },
            {
               "default" : null,
               "value_desc" : "key:value or key:op:value",
               "option" : "critical",
               "mandatory" : 0,
               "name" : "Critical threshold",
               "description" : "This is the critical threshold. When the value exceeds the threshold a critical status is triggered. Please see the examples for more information.",
               "multiple" : 1,
               "value_type" : "string"
            }
         ]
      }
   },
   "chart" : {
      "title" : "Linux netstat",
      "options" : {
         "ylabel" : "connections",
         "units" : "null",
         "chart-type" : "area",
         "series" : [
            {
               "name" : "established",
               "color" : "#e9644a"
            },
            {
               "color" : "#ffb244",
               "name" : "syn_send"
            },
            {
               "name" : "syn_recv",
               "color" : "#9a72ad"
            },
            {
               "name" : "fin_wait1",
               "color" : "#005467"
            },
            {
               "color" : "#2ba743",
               "name" : "fin_wait2"
            },
            {
               "color" : "#7648eb",
               "name" : "time_wait"
            },
            {
               "color" : "#7f7fff",
               "name" : "close"
            },
            {
               "color" : "#1c6d16",
               "name" : "close_wait"
            },
            {
               "color" : "#bf00bf",
               "name" : "last_ack"
            },
            {
               "color" : "#275487",
               "name" : "closing"
            },
            {
               "name" : "unknown",
               "color" : "#666666"
            }
         ]
      },
      "id" : "1"
   },
   "statistic" : [
      {
         "description" : "ESTABLISHED - The socket has an established connection.",
         "datatype" : "bigint",
         "statkey" : "established",
         "alias" : "Established"
      },
      {
         "statkey" : "syn_send",
         "alias" : "SYN sent",
         "description" : "SYN_SENT - The socket is actively attempting to establish a connection.",
         "datatype" : "bigint"
      },
      {
         "statkey" : "syn_recv",
         "alias" : "SYN received",
         "description" : "SYN_RECV - A connection request has been received from the network.",
         "datatype" : "bigint"
      },
      {
         "statkey" : "fin_wait1",
         "alias" : "FIN wait1",
         "description" : "FIN_WAIT1 - The socket is closed, and the connection is shutting down.",
         "datatype" : "bigint"
      },
      {
         "alias" : "FIN wait2",
         "statkey" : "fin_wait2",
         "datatype" : "bigint",
         "description" : "FIN_WAIT2 - Connection is closed, and the socket is waiting for a shutdown from the remote end."
      },
      {
         "statkey" : "time_wait",
         "alias" : "Time wait",
         "description" : "TIME_WAIT - The socket is waiting after close to handle packets still in the network.",
         "datatype" : "bigint"
      },
      {
         "statkey" : "close",
         "alias" : "Close",
         "description" : "CLOSE - The socket is not being used.",
         "datatype" : "bigint"
      },
      {
         "statkey" : "close_wait",
         "alias" : "Close wait",
         "description" : "CLOSE_WAIT - The remote end has shut down, waiting for the socket to close.",
         "datatype" : "bigint"
      },
      {
         "statkey" : "last_ack",
         "alias" : "Last ACK",
         "description" : "LAST_ACK - The remote end has shut down, and the socket is closed. Waiting for acknowledgement.",
         "datatype" : "bigint"
      },
      {
         "datatype" : "bigint",
         "description" : "CLOSING - Both sockets are shut down but we still don't have all our data sent.",
         "alias" : "Closing",
         "statkey" : "closing"
      },
      {
         "datatype" : "bigint",
         "description" : "UNKNOWN - The state of the socket is unknown.",
         "alias" : "Unknown",
         "statkey" : "unknown"
      }
   ]
}
