{
   "plugin" : {
      "id" : "23",
      "datatype" : "none",
      "description" : "Check if updates are available.",
      "category" : "System,Linux,Security",
      "abstract" : "Linux check updates",
      "plugin" : "Linux.Updates.Check",
      "command" : "check-linux-updates",
      "info" : {
         "version" : "0.5",
         "info" : [
            "This plugin works only on Linux distributions where the tools yum, dnf, apt or zypper are used as package manager. If yum is used, then you have to install the package yum-security. If dnf is used, then you should know that 'dnf updateinfo' is parsed to get a summary of available security updates."
         ],
         "plugin" : "check-linux-updates",
         "flags" : "sudo",
         "options" : [
            {
               "name" : "Warning threshold for normal packages",
               "description" : "Set this value to the maximum number of packages that may be available for an update. If more packages are available then a WARNING is triggered.",
               "value_desc" : "count",
               "option" : "warning",
               "default" : null,
               "multiple" : 0,
               "value_type" : "int",
               "mandatory" : 0
            },
            {
               "value_desc" : "count",
               "name" : "Critical threshold for normal packages",
               "description" : "Set this value to the maximum number of packages that may be available for an update. If more packages arei available then a CRITICAL is triggered.",
               "value_type" : "int",
               "mandatory" : 0,
               "multiple" : 0,
               "default" : null,
               "option" : "critical"
            },
            {
               "value_desc" : "count",
               "description" : "Set this value to the maximum number of packages that may be available for an update. If more packages are available then a WARNING is triggered.",
               "name" : "Warning threshold for security packages",
               "mandatory" : 0,
               "value_type" : "int",
               "multiple" : 0,
               "option" : "warning-security",
               "default" : null
            },
            {
               "option" : "critical-security",
               "default" : null,
               "multiple" : 0,
               "value_type" : "int",
               "mandatory" : 0,
               "description" : "Set this value to the maximum number of packages that may be available for an update. If more packages are available then a CRITICAL is triggered.",
               "name" : "Critical threshold for security packages",
               "value_desc" : "count"
            },
            {
               "mandatory" : 0,
               "value_type" : "number",
               "option" : "timeout",
               "default" : 30,
               "multiple" : 0,
               "name" : "Timeout",
               "description" : "A timeout in seconds after its expiration the check is aborted and a critical status is triggered.",
               "value_desc" : "seconds"
            }
         ],
         "examples" : [
            {
               "command_line" : "check-linux-updates --critical-security '1'",
               "description" : [
                  "Check if updates are available and trigger a critical status if",
                  "there is 1 or more as 1 package for security is available."
               ],
               "arguments" : [
                  "critical-security",
                  1
               ]
            }
         ]
      }
   }
}
