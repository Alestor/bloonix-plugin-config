{
   "plugin" : {
      "datatype" : "statistic",
      "prefer" : "remote",
      "plugin" : "IMAP.Check",
      "description" : "IMAP connect statistics",
      "abstract" : "IMAP check",
      "category" : "Network,Mail",
      "id" : "8",
      "command" : "check-imap",
      "info" : {
         "examples" : [
            {
               "description" : [
                  "A simple login check with username and password"
               ],
               "arguments" : [
                  "host",
                  "127.0.0.1",
                  "port",
                  993,
                  "warning",
                  5,
                  "critical",
                  10,
                  "use-ssl",
                  null,
                  "username",
                  "bloonix",
                  "password",
                  "secret"
               ],
               "command_line" : "check-imap --host '127.0.0.1' --port '993' --warning '5' --critical '10' --use-ssl --username 'bloonix' --password 'secret'"
            },
            {
               "description" : [
                  "In combination with the SMTP check of Bloonix it's possible to check a complete send-and-receive workflow. If you configure a SMTP check to send a mail with the subject 'Bloonix test mail' then it's possible to pick this mails with the IMAP check."
               ],
               "arguments" : [
                  "host",
                  "127.0.0.1",
                  "port",
                  993,
                  "warning",
                  5,
                  "critical",
                  10,
                  "use-ssl",
                  null,
                  "username",
                  "bloonix",
                  "password",
                  "secret",
                  "misses",
                  "5m",
                  "search",
                  "Bloonix test mail",
                  "delete",
                  null
               ],
               "command_line" : "check-imap --host '127.0.0.1' --port '993' --warning '5' --critical '10' --use-ssl --username 'bloonix' --password 'secret' --misses '5m' --search 'Bloonix test mail' --delete"
            }
         ],
         "options" : [
            {
               "mandatory" : 0,
               "name" : "Warning threshold",
               "option" : "warning",
               "value_desc" : "seconds",
               "description" : "A value in seconds. When the check takes longer than this time then a warning status is triggered.",
               "value_type" : "number",
               "multiple" : 0,
               "default" : 5
            },
            {
               "description" : "A value in seconds. When the check takes longer than this time then a critical status is triggered.",
               "value_desc" : "seconds",
               "option" : "critical",
               "name" : "Critical threshold",
               "value_type" : "number",
               "multiple" : 0,
               "default" : 8,
               "mandatory" : 0
            },
            {
               "multiple" : 0,
               "value_type" : "number",
               "value_desc" : "seconds",
               "description" : "A timeout in seconds after its expiration the check is aborted and a critical status is triggered.",
               "option" : "timeout",
               "name" : "Timeout",
               "default" : 10,
               "mandatory" : 0
            },
            {
               "mandatory" : 1,
               "name" : "Hostname or IP address",
               "description" : "A hostname or IP address to connect to.",
               "value_desc" : "hostname or ip address",
               "option" : "host",
               "multiple" : 0,
               "value_type" : "string",
               "default" : null
            },
            {
               "mandatory" : 1,
               "default" : null,
               "multiple" : 0,
               "value_type" : "int",
               "option" : "port",
               "description" : "A port number to connect to.",
               "value_desc" : "port",
               "name" : "Port number"
            },
            {
               "mandatory" : 0,
               "default" : null,
               "multiple" : 0,
               "value_type" : "string",
               "description" : "A local IP address to bind to.",
               "value_desc" : "ipaddr",
               "option" : "bind",
               "name" : "Bind to IP address"
            },
            {
               "default" : null,
               "mandatory" : 0,
               "multiple" : 0,
               "value_type" : 0,
               "name" : "Use IPv6",
               "option" : "use-ipv6",
               "description" : "Use IPv6 to connect to the host."
            },
            {
               "default" : null,
               "mandatory" : 0,
               "multiple" : 0,
               "value_type" : 0,
               "name" : "Use secure connection via SSL",
               "description" : "Use secure connection via SSL.",
               "option" : "use-ssl"
            },
            {
               "mandatory" : 0,
               "multiple" : 0,
               "value_type" : "string",
               "name" : "Username",
               "option" : "username",
               "description" : "The username to use for the login.",
               "value_desc" : "username",
               "default" : null
            },
            {
               "mandatory" : 0,
               "value_type" : "string",
               "multiple" : 0,
               "name" : "Password",
               "option" : "password",
               "description" : "The password for the user to login.",
               "value_desc" : "password",
               "default" : null
            },
            {
               "mandatory" : 0,
               "default" : "INBOX",
               "value_type" : "string",
               "multiple" : 0,
               "option" : "mailbox",
               "value_desc" : "mailbox",
               "description" : "The mailbox to query.",
               "name" : "Mailbox"
            },
            {
               "default" : null,
               "multiple" : 0,
               "value_type" : "string",
               "option" : "search",
               "value_desc" : "string",
               "description" : "Search for the given string in the subject of each mail.\nIn combination with the option 'Miss time' a critical\nstatus is triggered if the mail weren't found in the\nexpected time.",
               "name" : "Search for mails",
               "mandatory" : 0
            },
            {
               "mandatory" : 0,
               "multiple" : 0,
               "value_type" : "string",
               "name" : "Miss time",
               "option" : "misses",
               "value_desc" : "time",
               "description" : "With this option you can set a expire time. The units are 'm'\nfor minutes, 'h' for hours and 'd' for days. In combination with the\noption 'Search for mails' a critical status is triggered if a mail\nweren't found in the expected time. Note that if no unit is used\nthen this option acts like a counter. That means that a internal\ncounter is increased with each check if a mail weren't found.\nAfter X misses a critical status is triggered.",
               "default" : "10m"
            },
            {
               "default" : null,
               "mandatory" : 0,
               "multiple" : 0,
               "value_type" : 0,
               "description" : "Use this option if you want that a CRITICAL status is triggered if a mail is found.\nIf this option is enabled then the option 'misses' will be ignored.",
               "option" : "invert-regex",
               "name" : "Return CRITICAL, not OK"
            },
            {
               "value_type" : 0,
               "multiple" : 0,
               "option" : "delete",
               "description" : "If this option is set then all mails will be deleted from the mailbox\nBUT only if the subject of a mail contains the string that is set\nwith option 'search'.",
               "name" : "Delete found mails",
               "default" : null,
               "mandatory" : 0
            },
            {
               "multiple" : 0,
               "value_type" : 0,
               "name" : "Delete all mails",
               "option" : "delete-all",
               "description" : "If this option is set then all mails will be deleted from the mailbox\nafter the run.",
               "default" : null,
               "mandatory" : 0
            }
         ],
         "plugin" : "check-imap",
         "version" : "0.10",
         "flags" : ""
      },
      "netaccess" : "yes",
      "worldwide" : "yes"
   },
   "statistic" : {
      "description" : "Time in milliseconds waiting for response.",
      "units" : "ms",
      "alias" : "Response time",
      "statkey" : "time",
      "datatype" : "float"
   },
   "chart" : {
      "title" : "IMAP connect - response time",
      "id" : "1",
      "options" : {
         "units" : "null",
         "ylabel" : "time in ms",
         "chart-type" : "area",
         "series" : {
            "color" : "#005467",
            "name" : "time"
         }
      }
   }
}
