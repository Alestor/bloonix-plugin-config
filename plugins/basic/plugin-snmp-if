{
   "plugin" : {
      "description" : "Check the interfaces of routers and switches.",
      "plugin" : "SNMP.Interface",
      "netaccess" : "yes",
      "info" : {
         "thresholds" : {
            "info" : [
               "How to set warning and critical thresholds:\n\n",
               "  It's possible to set thresholds for one or more statistic keys.\n",
               "  The format to add a threshold for a statistic key is:\n\n",
               "    key:operator:threshold\n\n",
               "  or if a unit makes sense\n\n",
               "    key:operator:threshold + UNIT\n\n",
               "  where the unit can be in ",
               "bytes",
               ".\n\n",
               "  If no operator is set then the default operator is 'ge'.\n\n",
               "  The following operators are available:\n\n",
               "    lt = less than\n",
               "    le = less than or equal\n",
               "    gt = greater than\n",
               "    ge = greater than or equal\n",
               "    eq = equal\n",
               "    ne = not equal\n",
               "\n",
               "  Allowed units for bytes:\n\n",
               "    KB = Kilobytes   TB = Terabytes   ZB = Zettabytes\n",
               "    MB = Megabytes   PB = Petabytes   YB = Yottabytes\n",
               "    GB = Gigabytes   EB = Exabytes\n\n"
            ],
            "options" : [
               {
                  "key" : "in_discards",
                  "unit" : "bytes"
               },
               {
                  "unit" : "bytes",
                  "key" : "in_errors"
               },
               {
                  "key" : "out_discards",
                  "unit" : "bytes"
               },
               {
                  "unit" : "bytes",
                  "key" : "out_errors"
               },
               {
                  "unit" : "bytes",
                  "key" : "in_octets"
               },
               {
                  "unit" : "bytes",
                  "key" : "in_ucast_pkts"
               },
               {
                  "key" : "in_nucast_pkts",
                  "unit" : "bytes"
               },
               {
                  "key" : "in_multicast_pkts",
                  "unit" : "bytes"
               },
               {
                  "key" : "in_broadcast_pkts",
                  "unit" : "bytes"
               },
               {
                  "key" : "out_octets",
                  "unit" : "bytes"
               },
               {
                  "unit" : "bytes",
                  "key" : "out_ucast_pkts"
               },
               {
                  "key" : "out_nucast_pkts",
                  "unit" : "bytes"
               },
               {
                  "key" : "out_multicast_pkts",
                  "unit" : "bytes"
               },
               {
                  "key" : "out_broadcast_pkts",
                  "unit" : "bytes"
               }
            ]
         },
         "version" : "0.3",
         "examples" : [
            {
               "description" : [
                  "Monitor the interface eth0 (1.3.6.1.2.1.31.1.1.1.1) of a linux system:"
               ],
               "command_line" : "check-snmp-if --interface 'eth0' --host '127.0.0.1' --port '161' --community 'public' --snmp-version '1'",
               "arguments" : [
                  "interface",
                  "eth0",
                  "host",
                  "127.0.0.1",
                  "port",
                  161,
                  "community",
                  "public",
                  "snmp-version",
                  1
               ]
            },
            {
               "description" : [
                  "Monitor the interface 10 (1.3.6.1.2.1.2.2.1.2.10) of a cisco switch:"
               ],
               "command_line" : "check-snmp-if --interface '10' --host '127.0.0.1' --port '161' --community 'public' --snmp-version '1'",
               "arguments" : [
                  "interface",
                  10,
                  "host",
                  "127.0.0.1",
                  "port",
                  161,
                  "community",
                  "public",
                  "snmp-version",
                  1
               ]
            }
         ],
         "plugin" : "check-snmp-if",
         "flags" : "",
         "options" : [
            {
               "value_desc" : "interface",
               "option" : "interface",
               "multiple" : 0,
               "name" : "Network interface",
               "default" : null,
               "mandatory" : 1,
               "description" : "This is the network interface you want to check. The interface name should be the last digit of ifDescr (1.3.6.1.2.1.2.2.1.2.X) or the string that is found in ifName (1.3.6.1.2.1.31.1.1.1.1).",
               "value_type" : "string"
            },
            {
               "value_type" : "string",
               "description" : "A hostname or IP address to connect to.",
               "mandatory" : 0,
               "default" : "127.0.0.1",
               "name" : "Hostname or IP address",
               "multiple" : 0,
               "option" : "host",
               "value_desc" : "hostname or ip address"
            },
            {
               "description" : "A port number to connect to.",
               "mandatory" : 0,
               "default" : 161,
               "value_type" : "int",
               "value_desc" : "port",
               "option" : "port",
               "multiple" : 0,
               "name" : "Port number"
            },
            {
               "multiple" : 0,
               "option" : "community",
               "name" : "SNMP community",
               "value_desc" : "community",
               "value_type" : "string",
               "mandatory" : 0,
               "default" : "public",
               "description" : "The SNMP community to connect to the host."
            },
            {
               "value_desc" : "version",
               "name" : "SNMP version",
               "option" : "snmp-version",
               "multiple" : 0,
               "description" : "The SNMP version to use to connect to the host.",
               "default" : 2,
               "mandatory" : 0,
               "value_type" : "string"
            },
            {
               "value_type" : "string",
               "description" : "The SNMPv3 username.",
               "default" : null,
               "mandatory" : 0,
               "name" : "SNMPv3 username",
               "option" : "username",
               "multiple" : 0,
               "value_desc" : "username"
            },
            {
               "value_type" : "string",
               "description" : "The SNMPv3 auth key.",
               "mandatory" : 0,
               "default" : null,
               "name" : "SNMPv3 auth key",
               "multiple" : 0,
               "option" : "authkey",
               "value_desc" : "authkey"
            },
            {
               "value_desc" : "authpassword",
               "name" : "SNMPv3 auth password",
               "multiple" : 0,
               "option" : "authpassword",
               "mandatory" : 0,
               "default" : null,
               "description" : "The SNMPv3 auth password.",
               "value_type" : "string"
            },
            {
               "value_type" : "string",
               "description" : "The SNMPv3 auth protocol.",
               "mandatory" : 0,
               "default" : null,
               "option" : "authprotocol",
               "multiple" : 0,
               "name" : "SNMPv3 auth protocol",
               "value_desc" : "authprotocol"
            },
            {
               "value_desc" : "privkey",
               "option" : "privkey",
               "multiple" : 0,
               "name" : "SNMPv3 priv key",
               "default" : null,
               "mandatory" : 0,
               "description" : "The SNMPv3 priv key.",
               "value_type" : "string"
            },
            {
               "option" : "privpassword",
               "multiple" : 0,
               "name" : "SNMPv3 priv password",
               "value_desc" : "privpassword",
               "value_type" : "string",
               "description" : "The SNMPv3 priv password.",
               "default" : null,
               "mandatory" : 0
            },
            {
               "value_desc" : "privprotocol",
               "multiple" : 0,
               "option" : "privprotocol",
               "name" : "SNMPv3 priv protocol",
               "description" : "The SNMPv3 priv protocol.",
               "mandatory" : 0,
               "default" : null,
               "value_type" : "string"
            },
            {
               "value_desc" : "key:value or key:op:value",
               "name" : "Warning threshold",
               "multiple" : 1,
               "option" : "warning",
               "description" : "This is the warning threshold. When the value exceeds the threshold a warning status is triggered. Please see the examples for more information.",
               "default" : null,
               "mandatory" : 0,
               "value_type" : "string"
            },
            {
               "name" : "Critical threshold",
               "option" : "critical",
               "multiple" : 1,
               "value_desc" : "key:value or key:op:value",
               "value_type" : "string",
               "mandatory" : 0,
               "default" : null,
               "description" : "This is the critical threshold. When the value exceeds the threshold a critical status is triggered. Please see the examples for more information."
            },
            {
               "description" : "This flag enables to check if the status of ifAdminStatus is different from ifOperStatus. That means that if ifAdminStatus is configured to be up then ifOperStatus must also been up.",
               "default" : null,
               "mandatory" : 0,
               "name" : "Trigger a CRITICAL if not 'up'",
               "value_type" : 0,
               "multiple" : 0,
               "option" : "crit-if-not-up"
            }
         ]
      },
      "command" : "check-snmp-if",
      "prefer" : "localhost",
      "datatype" : "statistic",
      "abstract" : "Check snmp-if",
      "category" : "Network,SNMP",
      "id" : "12"
   },
   "chart" : [
      {
         "title" : "SNMP if - errors, discards",
         "options" : {
            "series" : [
               {
                  "color" : "#9a72ad",
                  "name" : "in_errors"
               },
               {
                  "color" : "#e9644a",
                  "name" : "in_discards"
               },
               {
                  "name" : "out_errors",
                  "opposite" : "true",
                  "color" : "#ffb244"
               },
               {
                  "opposite" : "true",
                  "name" : "out_discards",
                  "color" : "#2ba743"
               }
            ],
            "ylabel" : "packets in(+) / out(-)",
            "chart-type" : "area",
            "units" : "default"
         },
         "id" : "1"
      },
      {
         "id" : "2",
         "title" : "SNMP if - in/out octets",
         "options" : {
            "units" : "bytes_to_bits",
            "ylabel" : "octets",
            "chart-type" : "area",
            "series" : [
               {
                  "color" : "#005467",
                  "name" : "in_octets"
               },
               {
                  "name" : "out_octets",
                  "opposite" : "true",
                  "color" : "#ff7a0d"
               }
            ]
         }
      },
      {
         "id" : "3",
         "title" : "SNMP if - multicast, broadcast",
         "options" : {
            "units" : "default",
            "ylabel" : "packets in(+) / out(-)",
            "chart-type" : "area",
            "series" : [
               {
                  "color" : "#ffb244",
                  "name" : "in_ucast_pkts"
               },
               {
                  "color" : "#9a72ad",
                  "name" : "in_nucast_pkts"
               },
               {
                  "name" : "in_multicast_pkts",
                  "color" : "#005467"
               },
               {
                  "name" : "in_broadcast_pkts",
                  "color" : "#e9644a"
               },
               {
                  "opposite" : "true",
                  "name" : "out_ucast_pkts",
                  "color" : "#ffb244"
               },
               {
                  "color" : "#9a72ad",
                  "name" : "out_nucast_pkts",
                  "opposite" : "true"
               },
               {
                  "color" : "#005467",
                  "opposite" : "true",
                  "name" : "out_multicast_pkts"
               },
               {
                  "opposite" : "true",
                  "name" : "out_broadcast_pkts",
                  "color" : "#e9644a"
               }
            ]
         }
      }
   ],
   "statistic" : [
      {
         "statkey" : "admin_status",
         "alias" : "ifAdminStatus",
         "datatype" : "varchar(20)",
         "description" : "OID 1.3.6.1.2.1.2.2.1.7",
         "units" : "bytes"
      },
      {
         "units" : "bytes",
         "datatype" : "varchar(20)",
         "description" : "OID 1.3.6.1.2.1.2.2.1.8",
         "statkey" : "oper_status",
         "alias" : "ifOperStatus"
      },
      {
         "units" : "bytes",
         "datatype" : "float",
         "description" : "OID 1.3.6.1.2.1.2.2.1.13",
         "statkey" : "in_discards",
         "alias" : "ifInDiscards"
      },
      {
         "datatype" : "float",
         "description" : "OID 1.3.6.1.2.1.2.2.1.14",
         "units" : "bytes",
         "statkey" : "in_errors",
         "alias" : "ifInErrors"
      },
      {
         "statkey" : "out_discards",
         "alias" : "ifOutDiscards",
         "units" : "bytes",
         "datatype" : "float",
         "description" : "OID 1.3.6.1.2.1.2.2.1.19"
      },
      {
         "description" : "OID 1.3.6.1.2.1.2.2.1.20",
         "datatype" : "float",
         "units" : "bytes",
         "alias" : "ifOutErrors",
         "statkey" : "out_errors"
      },
      {
         "units" : "bytes",
         "datatype" : "float",
         "description" : "OID 1.3.6.1.2.1.2.2.1.10, 1.3.6.1.2.1.31.1.1.1.6",
         "statkey" : "in_octets",
         "alias" : "ifInOctets"
      },
      {
         "description" : "OID 1.3.6.1.2.1.2.2.1.11, 1.3.6.1.2.1.31.1.1.1.7",
         "datatype" : "float",
         "units" : "bytes",
         "alias" : "ifInUcastPkts",
         "statkey" : "in_ucast_pkts"
      },
      {
         "alias" : "ifInNUcastPkts",
         "statkey" : "in_nucast_pkts",
         "description" : "OID 1.3.6.1.2.1.2.2.1.12",
         "datatype" : "float",
         "units" : "bytes"
      },
      {
         "alias" : "ifOutOctets",
         "statkey" : "out_octets",
         "description" : "OID 1.3.6.1.2.1.2.2.1.16, 1.3.6.1.2.1.31.1.1.1.10",
         "datatype" : "float",
         "units" : "bytes"
      },
      {
         "units" : "bytes",
         "datatype" : "float",
         "description" : "OID 1.3.6.1.2.1.2.2.1.17, 1.3.6.1.2.1.31.1.1.1.11",
         "statkey" : "out_ucast_pkts",
         "alias" : "ifOutUcastPkts"
      },
      {
         "units" : "bytes",
         "description" : "OID 1.3.6.1.2.1.2.2.1.18",
         "datatype" : "float",
         "alias" : "ifOutNUcastPkts",
         "statkey" : "out_nucast_pkts"
      },
      {
         "datatype" : "float",
         "description" : "OID 1.3.6.1.2.1.31.1.1.1.9",
         "units" : "bytes",
         "statkey" : "in_broadcast_pkts",
         "alias" : "ifHCInBroadcastPkts"
      },
      {
         "statkey" : "in_multicast_pkts",
         "alias" : "ifHCInMulticastPkts",
         "units" : "bytes",
         "datatype" : "float",
         "description" : "OID 1.3.6.1.2.1.31.1.1.1.8"
      },
      {
         "units" : "bytes",
         "datatype" : "float",
         "description" : "OID 1.3.6.1.2.1.31.1.1.1.12",
         "statkey" : "out_multicast_pkts",
         "alias" : "ifHCOutMulticastPkts"
      },
      {
         "units" : "bytes",
         "datatype" : "float",
         "description" : "OID 1.3.6.1.2.1.31.1.1.1.13",
         "statkey" : "out_broadcast_pkts",
         "alias" : "ifHCOutBroadcastPkts"
      }
   ]
}
