{
   "plugin" : {
      "abstract" : "DNS check",
      "datatype" : "statistic",
      "plugin" : "DNS.Check",
      "category" : "Network,DNS",
      "worldwide" : "yes",
      "id" : "4",
      "command" : "check-dns",
      "prefer" : "remote",
      "info" : {
         "examples" : [
            {
               "arguments" : [
                  "nameserver",
                  "dns.example.test",
                  "hostname",
                  "bloonix.de",
                  "ipaddr",
                  "192.168.10.11",
                  "type",
                  "A"
               ],
               "description" : [
                  "In the following example a DNS request is send to the nameserver dns.example.test for the domain bloonix.de and the record type A. In the response of the DNS server the IP address 192.168.10.11 is expected. A CRITICAL status is triggered if the IP address is not present in the response."
               ],
               "command_line" : "check-dns --nameserver 'dns.example.test' --hostname 'bloonix.de' --ipaddr '192.168.10.11' --type 'A'"
            }
         ],
         "plugin" : "check-dns",
         "flags" : "",
         "options" : [
            {
               "default" : null,
               "value_type" : "string",
               "value_desc" : "ip,ip,ip",
               "description" : "This is the IP address of the DNS server to request.",
               "mandatory" : 1,
               "multiple" : 0,
               "name" : "The nameserver to connect",
               "option" : "nameserver"
            },
            {
               "mandatory" : 1,
               "name" : "The hostname to query",
               "multiple" : 0,
               "option" : "hostname",
               "default" : null,
               "value_type" : "string",
               "value_desc" : "hostname",
               "description" : "This is the hostname or address to query."
            },
            {
               "mandatory" : 0,
               "option" : "type",
               "name" : "The record type to query",
               "multiple" : 0,
               "value_type" : "string",
               "default" : "A",
               "description" : "This is the record type that is expected in combination with the IP address. It's possible to search for type A or AAAA.",
               "value_desc" : "type"
            },
            {
               "default" : null,
               "value_type" : "string",
               "value_desc" : "address",
               "description" : "Enter a IP address that is expected in combination with the record type.",
               "mandatory" : 1,
               "name" : "The IP address to expect",
               "multiple" : 0,
               "option" : "ipaddr"
            },
            {
               "mandatory" : 0,
               "option" : "warning",
               "name" : "Warning threshold",
               "multiple" : 0,
               "value_type" : "number",
               "default" : 3,
               "description" : "A value in seconds. When the check takes longer than this time then a warning status is triggered.",
               "value_desc" : "seconds"
            },
            {
               "mandatory" : 0,
               "multiple" : 0,
               "name" : "Critical threshold",
               "option" : "critical",
               "default" : 5,
               "value_type" : "number",
               "value_desc" : "seconds",
               "description" : "A value in seconds. When the check takes longer than this time then a critical status is triggered."
            },
            {
               "value_type" : "number",
               "default" : 10,
               "description" : "A timeout in seconds after its expiration the check is aborted and a critical status is triggered.",
               "value_desc" : "seconds",
               "mandatory" : 0,
               "option" : "timeout",
               "multiple" : 0,
               "name" : "Timeout"
            }
         ],
         "version" : "0.4"
      },
      "netaccess" : "yes",
      "description" : "Check DNS records."
   },
   "statistic" : {
      "description" : "Time in milliseconds waiting for response.",
      "statkey" : "time",
      "units" : "ms",
      "alias" : "Response time",
      "datatype" : "float"
   },
   "chart" : {
      "title" : "DNS request - response time",
      "id" : "1",
      "options" : {
         "ylabel" : "time in ms",
         "chart-type" : "area",
         "series" : {
            "name" : "time",
            "color" : "#005467"
         },
         "units" : "null"
      }
   }
}
