{
   "plugin" : {
      "category" : "System,Security",
      "id" : "5",
      "description" : "Check the status of a file.",
      "plugin" : "Filestat.Check",
      "abstract" : "Check filestat",
      "command" : "check-filestat",
      "datatype" : "statistic",
      "info" : {
         "plugin" : "check-filestat",
         "thresholds" : {
            "options" : [
               {
                  "unit" : "bytes",
                  "key" : "size"
               },
               {
                  "key" : "mode",
                  "unit" : "none"
               },
               {
                  "unit" : "none",
                  "key" : "nlink"
               },
               {
                  "unit" : "none",
                  "key" : "uid"
               },
               {
                  "unit" : "none",
                  "key" : "gid"
               },
               {
                  "unit" : "none",
                  "key" : "atime"
               },
               {
                  "unit" : "none",
                  "key" : "diff_atime"
               },
               {
                  "key" : "mtime",
                  "unit" : "none"
               },
               {
                  "unit" : "none",
                  "key" : "diff_mtime"
               }
            ],
            "info" : [
               "How to set warning and critical thresholds:\n\n",
               "  It's possible to set thresholds for one or more statistic keys.\n",
               "  The format to add a threshold for a statistic key is:\n\n",
               "    key:operator:threshold\n\n",
               "  or if a unit makes sense\n\n",
               "    key:operator:threshold + UNIT\n\n",
               "  where the unit can be in ",
               "bytes",
               ".\n\n",
               "  If no operator is set then the default operator is 'ge'.\n\n",
               "  The following operators are available:\n\n",
               "    lt = less than\n",
               "    le = less than or equal\n",
               "    gt = greater than\n",
               "    ge = greater than or equal\n",
               "    eq = equal\n",
               "    ne = not equal\n",
               "\n",
               "  Allowed units for bytes:\n\n",
               "    KB = Kilobytes   TB = Terabytes   ZB = Zettabytes\n",
               "    MB = Megabytes   PB = Petabytes   YB = Yottabytes\n",
               "    GB = Gigabytes   EB = Exabytes\n\n"
            ]
         },
         "version" : "0.2",
         "flags" : "",
         "examples" : [
            {
               "command_line" : "check-filestat --file '/var/log/test.log' --warning 'size:gt:1MB' --critical 'size:gt:5MB'",
               "arguments" : [
                  "file",
                  "/var/log/test.log",
                  "warning",
                  "size:gt:1MB",
                  "critical",
                  "size:gt:5MB"
               ],
               "description" : [
                  "NOTE: please create the configuration file '/etc/bloonix/agent/check-filestat.conf' on your server and write all file names into the file (one file per line) that the Bloonix agent is allowed to check!",
                  "",
                  "In this example the file of /var/log/test.log is checked. If the file size is higher than 1MB a warning is triggered. If the file size is higher than 5MB a critical is triggered."
               ]
            }
         ],
         "options" : [
            {
               "value_type" : "string",
               "default" : null,
               "description" : "This is the file name to check.",
               "value_desc" : "file",
               "multiple" : 0,
               "name" : "Filename",
               "mandatory" : 1,
               "option" : "file"
            },
            {
               "mandatory" : 0,
               "name" : "Warning threshold",
               "multiple" : 1,
               "option" : "warning",
               "value_type" : "string",
               "value_desc" : "key:value or key:op:value",
               "default" : null,
               "description" : "This is the warning threshold. When the value exceeds the threshold a warning status is triggered. Please see the examples for more information."
            },
            {
               "description" : "This is the critical threshold. When the value exceeds the threshold a critical status is triggered. Please see the examples for more information.",
               "default" : null,
               "value_desc" : "key:value or key:op:value",
               "value_type" : "string",
               "option" : "critical",
               "multiple" : 1,
               "name" : "Critical threshold",
               "mandatory" : 0
            },
            {
               "default" : null,
               "option" : "ignore-missing",
               "description" : "Enable this options if it's ok if the file does not exists.",
               "value_type" : 0,
               "multiple" : 0,
               "name" : "Ignore missing file",
               "mandatory" : 0
            }
         ]
      }
   },
   "statistic" : [
      {
         "alias" : "File size",
         "units" : "bytes",
         "datatype" : "float",
         "statkey" : "size",
         "description" : "The size of the file in bytes."
      },
      {
         "description" : "File mode (type and permissions).",
         "datatype" : "varchar(10)",
         "statkey" : "mode"
      },
      {
         "description" : "Number of (hard) links to the file.",
         "statkey" : "nlink",
         "datatype" : "bigint"
      },
      {
         "datatype" : "varchar(10)",
         "statkey" : "uid",
         "description" : "Numeric user ID of file's owner."
      },
      {
         "description" : "Numeric group ID of file's owner.",
         "statkey" : "gid",
         "datatype" : "varchar(10)"
      },
      {
         "description" : "Last access time in seconds since the epoch.",
         "statkey" : "atime",
         "datatype" : "bigint",
         "units" : "unixtime"
      },
      {
         "units" : "unixtime",
         "description" : "The time in seconds since the last access to the file.",
         "datatype" : "bigint",
         "statkey" : "diff_atime"
      },
      {
         "description" : "Last modify time in seconds since the epoch.",
         "datatype" : "bigint",
         "statkey" : "mtime",
         "units" : "unixtime"
      },
      {
         "description" : "The time in seconds since the last modification of the file.",
         "statkey" : "diff_mtime",
         "datatype" : "bigint",
         "units" : "unixtime"
      }
   ],
   "chart" : {
      "title" : "File size",
      "options" : {
         "units" : "bytes",
         "chart-type" : "area",
         "ylabel" : "size",
         "series" : {
            "name" : "size",
            "color" : "#005467"
         }
      },
      "id" : "1"
   }
}
